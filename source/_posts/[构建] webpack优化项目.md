---
title: webpack 优化项目策略
date: 2018-09-29 10:20:51
tags: [webpack]
categories: 构建
toc: true
---

优化可以分为`优化开发体验`和`优化输出质量`两部分。
## 优化开发体验
优化开发体验的目的是为了提升开发时的效率

### 1.优化构建速度
[缩小文件搜索范围]()
[使用 DllPlugin]()
[使用 HappyPack]()
[使用 ParallelUglifyPlugin]()

### 2.优化使用体验
[使用自动刷新]()
[开启模块热替换]()

## 优化输出质量
优化输出质量的目的是为了给用户呈现体验更好的网页，例如减少首屏加载时间、提升性能流畅度等。

### 1.减少用户能感知到的加载时间(首屏加载时间)
[区分环境]()
[压缩代码]()
[CDN 加速]()
[使用 Tree Shaking]()
[提取公共代码]()
[按需加载]()

### 2.提升流畅度(提升代码性能)
[使用 Prepack]()
[开启 Scope Hoisting]()

#### 缩小文件搜索范围 resolve
Webpack 启动后会从配置的 Entry 出发，解析出文件中的导入语句，再递归的解析。 
在遇到导入语句时 Webpack 会做两件事情：
1、根据导入语句去寻找对应的要导入的文件。
  例如 require('react') 导入语句对应的文件是 ./node_modules/react/react.js， require('./util') 对应的文件是 ./util.js。
2、根据找到的要导入文件的后缀，使用配置中的 Loader 去处理文件。
  例如使用 ES6 开发的 JavaScript 文件需要使用 babel-loader 去处理。


#### DllPlugin
动态链接库: 可包含给其他模块调用的函数和数据。
要给 Web 项目构建接入动态链接库的思想，需要完成以下事情：
1、把网页依赖的基础模块抽离出来，打包到一个个单独的动态链接库中去。一个动态链接库中可以包含多个模块。
2、当需要导入的模块存在于某个动态链接库中时，这个模块不能被再次被打包，而是去动态链接库中获取。
3、页面依赖的所有动态链接库需要被加载。

 Web 项目构建接入动态链接库的思想后，会大大提升构建速度。
 原因：包含大量复用模块的动态链接库只需要编译一次，在之后的构建过程中被动态链接库包含的模块将不会在重新编译，而是直接使用动态链接库中的代码。
 由于动态链接库中大多数包含的是常用的第三方模块，例如 react、react-dom，只要不升级这些模块的版本，动态链接库就不用重新编译。



`DllPlugin`: 打包出一个个单独的动态链接库文件。
`DllReferencePlugin`: 将打包好的dll文件传入构建的代码里面，主要配置文件中去引入 DllPlugin 插件打包好的动态链接库文件
`AddAssetHtmlPlugin`: 在生成的html文件中加入dll文件的script引用